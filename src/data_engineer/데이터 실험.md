# Faster R-CNN:

1. 원본 데이터(Resize 가능) 학습 모델 mAP 점수

2. padding, Resize, 선명도 조작 데이터 학습 모델 mAP 점수

2. padding, Resize, rotation 조작 데이터 학습 모델 mAP 점수




##### Faster R-CNN 2번 예제 데이터 생성 코드
"""
import os
from Faster_RCNN_dataset import FasterRCNNDataset
from Faster_RCNN_dataset import TestDataset
import Faster_RCNN_dataloader
from sklearn.model_selection import train_test_split
import glob
from torchvision.transforms import v2
from class_mapping import read_classID
import torch


transforms = v2.Compose([
        v2.ToImage(),
        v2.ToDtype(torch.float32, scale=True),
        v2.Pad(                      # 남는 쪽 패딩
        padding=(152,0),
        fill=0,                  # 검정 패딩 (RGB면 (0,0,0))
        padding_mode="constant"
    ),
    v2.RandomAdjustSharpness(sharpness_factor=100.0, p=1.0),
    v2.Resize((600,600)),
])

master_dir = r".\ai-07-object-detection\sprint_ai_project1_data"              #   <-- 마스터 경로 입력
test_dir = r".\ai-07-object-detection\sprint_ai_project1_data\test_images"    #   <-- 테스트 이미지 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")              #   <-- 마스터 경로 아래 json 폴더 이름
image_dir = os.path.join(master_dir, r"train_images")                       #   <-- 마스터 경로 아래 이미지 폴더 이름

class_dict = read_classID(anntation_dir)        #       <-- annotation_dir의 ClassID.txt 파일

test_dataset = TestDataset(test_dir, transforms)                                        #   <-- test 데이터 class 객체 생성

img_path_list = glob.glob(os.path.join(image_dir, "**"), recursive=True)    #   split 모드 <-- 이미지 경로 리스트를 받아 dataset 생성
train_imgs_path, val_imgs_path = train_test_split(img_path_list, test_size=0.2, random_state=42, shuffle=True)

train_dataset = FasterRCNNDataset(image_dir, anntation_dir, class_dict, transforms, img_path_list_mode=True, img_path_list=train_imgs_path)   #   img_path_list_mode == 이미지 경로 리스트 형태로 받음
valid_dataset = FasterRCNNDataset(image_dir, anntation_dir, class_dict, transforms, img_path_list_mode=True, img_path_list=val_imgs_path)

print(len(train_dataset), len(valid_dataset))

train_dataloader = Faster_RCNN_dataloader.full_train_build_dataloaders(train_dataset,4)
valid_dataloader = Faster_RCNN_dataloader.full_train_build_dataloaders(valid_dataset,4)

test_dataloader = Faster_RCNN_dataloader.test_build_dataloaders(test_dataset,4)
"""




##### Faster R-CNN 3번 데이터 생성 예제 코드
"""
import os
from Faster_RCNN_dataset import FasterRCNNDataset
from Faster_RCNN_dataset import TestDataset
import Faster_RCNN_dataloader
from sklearn.model_selection import train_test_split
import glob
from torchvision.transforms import v2
from class_mapping import read_classID
import torch


transforms = v2.Compose([
        v2.ToImage(),
        v2.ToDtype(torch.float32, scale=True),
        v2.Pad(                      # 남는 쪽 패딩
        padding=(152,0),
        fill=0,                  # 검정 패딩 (RGB면 (0,0,0))
        padding_mode="constant"
    ),
    v2.RandomRotation(360,fill=0),
    v2.Resize((600,600)),
])

transforms_test = v2.Compose([
        v2.ToImage(),
        v2.ToDtype(torch.float32, scale=True),
        v2.Pad(                      # 남는 쪽 패딩
        padding=(152,0),
        fill=0,                  # 검정 패딩 (RGB면 (0,0,0))
        padding_mode="constant"
    ),
    v2.Resize((600,600)),
])

master_dir = r".\ai-07-object-detection\sprint_ai_project1_data"              #   <-- 마스터 경로 입력
test_dir = r".\ai-07-object-detection\sprint_ai_project1_data\test_images"    #   <-- 테스트 이미지 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")              #   <-- 마스터 경로 아래 json 폴더 이름
image_dir = os.path.join(master_dir, r"train_images")                       #   <-- 마스터 경로 아래 이미지 폴더 이름

class_dict = read_classID(anntation_dir)        #       <-- annotation_dir의 ClassID.txt 파일

test_dataset = TestDataset(test_dir, transforms_test)                                        #   <-- test 데이터 class 객체 생성

img_path_list = glob.glob(os.path.join(image_dir, "**"), recursive=True)    #   split 모드 <-- 이미지 경로 리스트를 받아 dataset 생성
train_imgs_path, val_imgs_path = train_test_split(img_path_list, test_size=0.2, random_state=42, shuffle=True)

train_dataset = FasterRCNNDataset(image_dir, anntation_dir, class_dict, transforms, img_path_list_mode=True, img_path_list=train_imgs_path)   #   img_path_list_mode == 이미지 경로 리스트 형태로 받음
valid_dataset = FasterRCNNDataset(image_dir, anntation_dir, class_dict, transforms, img_path_list_mode=True, img_path_list=val_imgs_path)

print(len(train_dataset), len(valid_dataset))

train_dataloader = Faster_RCNN_dataloader.full_train_build_dataloaders(train_dataset,4)
valid_dataloader = Faster_RCNN_dataloader.full_train_build_dataloaders(valid_dataset,4)

test_dataloader = Faster_RCNN_dataloader.test_build_dataloaders(test_dataset,4)
"""









# YOLO:

1. 원본 데이터 학습 모델 mAP 점수

2. 선명도 조작 데이터 학습 모델 mAP 점수

3. 원본 + 증강 데이터 학습 모델 mAP 점수

4. 원본 + 증강 데이터 학습 모델 mAP 점수




##### YOLO 2번 데이터 생성 예제 코드 (데이터 생성 10분 이상 소요) (새로 생성된 test 데이터 사용)
"""
from make_YOLO_annotation import make_YOLO_annotation
from yolo_data_split import split_yolo_dataset
from class_mapping import read_classID
from yolo_get_file_name_list import get_file_name_YOLO
from torchvision.transforms import v2
from yolo_img_converter import apply_v2_compose_and_save

import os

master_dir = r".\ai-07-object-detection\sprint_ai_project1_data"     #   <-- 마스터 경로 입력
test_dir = r".\ai-07-object-detection\sprint_ai_project1_data\test_images"    #   <-- 테스트 이미지 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")                              #   <-- 마스터 경로 아래 json 폴더 이름
image_dir = os.path.join(master_dir, r"train_images")                                       #   <-- 마스터 경로 아래 이미지 폴더 이름

class_dict = read_classID(anntation_dir)                                                    #       <-- annotation_dir의 ClassID.txt 파일

a_list = None
a_list = get_file_name_YOLO(anntation_dir,image_dir, -8)                                        #   <-- a_list(valid 데이터 이름 리스트를 가져옴)

transforms = v2.Compose([            # 이미지 변환에 사용할 v2.Copmpose --> bbox에 영향을 받지 않는 변환만 가능합니다. (padding, rotation, resize 등 안됨)
    v2.RandomAdjustSharpness(sharpness_factor=50.0, p=1.0),
])

image_dir = apply_v2_compose_and_save(transforms, image_dir, master_dir, output_dir_name="converted img")        # RandomAdjustSharpness 적용
test_image_dir = apply_v2_compose_and_save(transforms, test_dir, master_dir, output_dir_name="new_test_img")        # RandomAdjustSharpness 적용


yolo_annotation_dir = make_YOLO_annotation(image_dir, anntation_dir, class_dict, "YOLO_annotation_file")    #   <-- yolo annotation 파일 생성. 생성된 폴더 경로를 반환 (anntation_dir 아래 YOLO_annotation_file 이름으로 파일이 생성됩니다.)

split_yolo_dataset(
        image_dir=image_dir,                    #   <-- 원본 이미지 폴더
        anntation_dir=yolo_annotation_dir,      #   <-- 원본 annotation(txt) 폴더
        output_dir=master_dir,                  #   <-- 결과 저장 폴더
        val_ratio=0.2,                           #   <-- train 80% valid 20%
        file_name_list=a_list                   #   <-- Valid 파일 이름 리스트
)

print(f"테스트 이미지 경로: {test_image_dir}")
"""


##### YOLO 3번 데이터 생성 예제 코드 (기존 test 데이터 사용)
"""
from make_YOLO_annotation import make_YOLO_annotation
from yolo_data_split import split_yolo_dataset
from class_mapping import read_classID
from yolo_get_file_name_list import get_file_name_YOLO
from torchvision.transforms import v2
from YOLO_data_maker import data_maker
import os

master_dir = r".\ai-07-object-detection\sprint_ai_project1_data"     #   <-- 마스터 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")                              #   <-- 마스터 경로 아래 json 폴더 이름
image_dir = os.path.join(master_dir, r"train_images")                                       #   <-- 마스터 경로 아래 이미지 폴더 이름


class_dict = read_classID(anntation_dir)                                                    #       <-- annotation_dir의 ClassID.txt 파일

a_list = None
a_list = get_file_name_YOLO(anntation_dir,image_dir, -8)                                        #   <-- a_list(valid 데이터 이름 리스트를 가져옴)


yolo_annotation_dir = make_YOLO_annotation(image_dir, anntation_dir, class_dict, "YOLO_annotation_file")    #   <-- yolo annotation 파일 생성. 생성된 폴더 경로를 반환 (anntation_dir 아래 YOLO_annotation_file 이름으로 파일이 생성됩니다.)

split_yolo_dataset(
        image_dir=image_dir,                    #   <-- 원본 이미지 폴더
        anntation_dir=yolo_annotation_dir,      #   <-- 원본 annotation(txt) 폴더
        output_dir=master_dir,                  #   <-- 결과 저장 폴더
        val_ratio=0.2,                           #   <-- train 80% valid 20%
        file_name_list=a_list                   #   <-- Valid 파일 이름 리스트
)

img_train_dir = os.path.join(master_dir, "images", "train")
label_train_dir = os.path.join(master_dir, "labels", "train")

transforms = v2.Compose([
    v2.RandomRotation(360)
])

file_list1 =    ['K-001900-016548-019607-029451_0_2_0_2_70_000_200.png',        # 10번
                'K-001900-016548-019607-029451_0_2_0_2_75_000_200.png',
                'K-001900-016548-019607-029451_0_2_0_2_90_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_70_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_75_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_90_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_70_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_75_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_90_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_70_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_75_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_90_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_70_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_75_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_90_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_70_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_75_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_90_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_70_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_75_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_90_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_70_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_75_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_90_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_70_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_75_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_90_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_70_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_75_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_90_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_70_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_75_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_90_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_70_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_75_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_90_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_70_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_75_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_90_000_200.png']


file_list2 = ['K-001900-016548-019607-029451_0_2_0_2_70_000_200.png',        # 4번
            'K-001900-016548-019607-029451_0_2_0_2_75_000_200.png',
            'K-001900-016548-019607-029451_0_2_0_2_90_000_200.png',
            'K-001900-016548-019607-033009_0_2_0_2_70_000_200.png',
            'K-001900-016548-019607-033009_0_2_0_2_75_000_200.png',
            'K-001900-016548-019607-033009_0_2_0_2_90_000_200.png',
            'K-001900-016548-024850-029345_0_2_0_2_70_000_200.png',
            'K-001900-016548-024850-029345_0_2_0_2_75_000_200.png',
            'K-001900-016548-024850-029345_0_2_0_2_90_000_200.png',
            'K-001900-016551-029345-033208_0_2_0_2_70_000_200.png',
            'K-001900-016551-029345-033208_0_2_0_2_75_000_200.png',
            'K-001900-016551-029345-033208_0_2_0_2_90_000_200.png',
            'K-002483-003743-012778-013395_0_2_0_2_70_000_200.png',
            'K-002483-003743-012778-013395_0_2_0_2_75_000_200.png',
            'K-002483-003743-012778-013395_0_2_0_2_90_000_200.png',
            'K-002483-012081-012778-025438_0_2_0_2_70_000_200.png',
            'K-002483-012081-012778-025438_0_2_0_2_75_000_200.png',
            'K-002483-012081-012778-025438_0_2_0_2_90_000_200.png',
            'K-003351-003832-016688_0_2_0_2_70_000_200.png',
            'K-003351-016688-018147_0_2_0_2_70_000_200.png',
            'K-003351-016688-018147_0_2_0_2_75_000_200.png',
            'K-003351-016688-018357_0_2_0_2_75_000_200.png',
            'K-003351-016688-019232_0_2_0_2_90_000_200.png',
            'K-003351-016688-020014_0_2_0_2_90_000_200.png',
            'K-003351-016688-031863_0_2_0_2_90_000_200.png',
            'K-003351-016688-041768_0_2_0_2_90_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_70_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_75_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_90_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_70_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_75_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_90_000_200.png',
            'K-003544-004543-012247-016548_0_2_0_2_70_000_200.png',
            'K-003544-004543-012247-016548_0_2_0_2_75_000_200.png',
            'K-003544-004543-012247-016548_0_2_0_2_90_000_200.png',
            'K-003544-004543-016548-027993_0_2_0_2_70_000_200.png',
            'K-003544-004543-016548-027993_0_2_0_2_75_000_200.png',
            'K-003544-004543-016548-027993_0_2_0_2_90_000_200.png']


file_list3 = ['K-002483-003743-012778-013395_0_2_0_2_70_000_200.png',        # 3번
            'K-002483-003743-012778-013395_0_2_0_2_75_000_200.png',
            'K-002483-003743-012778-013395_0_2_0_2_90_000_200.png',
            'K-002483-012081-012778-025438_0_2_0_2_70_000_200.png',
            'K-002483-012081-012778-025438_0_2_0_2_75_000_200.png',
            'K-002483-012081-012778-025438_0_2_0_2_90_000_200.png',
            'K-002483-019552-022362-025438_0_2_0_2_70_000_200.png',
            'K-002483-019552-022362-025438_0_2_0_2_75_000_200.png',
            'K-002483-019552-022362-025438_0_2_0_2_90_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_70_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_75_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_90_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_70_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_75_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_90_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_70_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_75_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_90_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_70_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_75_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_90_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_70_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_75_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_90_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_70_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_75_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_90_000_200.png',
            'K-003483-022347-027777-035206_0_2_0_2_70_000_200.png',
            'K-003483-022347-027777-035206_0_2_0_2_75_000_200.png',
            'K-003483-022347-027777-035206_0_2_0_2_90_000_200.png',
            'K-003483-025469-028763-035206_0_2_0_2_70_000_200.png',
            'K-003483-025469-028763-035206_0_2_0_2_75_000_200.png',
            'K-003483-025469-028763-035206_0_2_0_2_90_000_200.png',
            'K-003483-025469-030308-035206_0_2_0_2_70_000_200.png',
            'K-003483-025469-030308-035206_0_2_0_2_75_000_200.png',
            'K-003483-025469-030308-035206_0_2_0_2_90_000_200.png']


file_list4 = ['K-003351-016232-018357_0_2_0_2_75_000_200.png',      # 2번
            'K-003351-016232-031863_0_2_0_2_90_000_200.png',
            'K-003351-016262-018357_0_2_0_2_90_000_200.png',
            'K-003351-016262-031863_0_2_0_2_70_000_200.png',
            'K-003351-016688-018357_0_2_0_2_75_000_200.png',
            'K-003351-016688-031863_0_2_0_2_90_000_200.png',
            'K-003351-018357-020238_0_2_0_2_70_000_200.png',
            'K-003351-018357-020238_0_2_0_2_75_000_200.png',
            'K-003351-018357-021325_0_2_0_2_70_000_200.png',
            'K-003351-018357-021325_0_2_0_2_90_000_200.png',
            'K-003351-018357-022074_0_2_0_2_90_000_200.png',
            'K-003351-018357-035206_0_2_0_2_70_000_200.png',
            'K-003351-018357-036637_0_2_0_2_75_000_200.png',
            'K-003351-018357-036637_0_2_0_2_90_000_200.png',
            'K-003351-018357-038162_0_2_0_2_90_000_200.png',
            'K-003351-020238-031863_0_2_0_2_70_000_200.png',
            'K-003351-020238-031863_0_2_0_2_90_000_200.png',
            'K-003351-021325-031863_0_2_0_2_70_000_200.png',
            'K-003351-021325-031863_0_2_0_2_75_000_200.png',
            'K-003351-022074-031863_0_2_0_2_75_000_200.png',
            'K-003351-029667-031863_0_2_0_2_70_000_200.png',
            'K-003351-029667-031863_0_2_0_2_75_000_200.png',
            'K-003351-031863-035206_0_2_0_2_75_000_200.png',
            'K-003351-031863-038162_0_2_0_2_70_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_70_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_75_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_90_000_200.png',
            'K-003483-016232-020877-034597_0_2_0_2_70_000_200.png',
            'K-003483-016232-020877-034597_0_2_0_2_75_000_200.png',
            'K-003483-016232-020877-034597_0_2_0_2_90_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_70_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_75_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_90_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_70_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_75_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_90_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_70_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_75_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_90_000_200.png',
            'K-003483-020877-025367-035206_0_2_0_2_70_000_200.png',
            'K-003483-020877-025367-035206_0_2_0_2_75_000_200.png',
            'K-003483-020877-025367-035206_0_2_0_2_90_000_200.png',
            'K-003483-020877-031885-036637_0_2_0_2_70_000_200.png',
            'K-003483-020877-031885-036637_0_2_0_2_75_000_200.png',
            'K-003483-020877-031885-036637_0_2_0_2_90_000_200.png',
            'K-003483-025367-025469-035206_0_2_0_2_70_000_200.png',
            'K-003483-025367-025469-035206_0_2_0_2_75_000_200.png',
            'K-003483-025367-025469-035206_0_2_0_2_90_000_200.png',
            'K-003483-025367-027733-029667_0_2_0_2_70_000_200.png',
            'K-003483-025367-027733-029667_0_2_0_2_75_000_200.png',
            'K-003483-025367-027733-029667_0_2_0_2_90_000_200.png',
            'K-003483-025367-027733-035206_0_2_0_2_70_000_200.png',
            'K-003483-025367-027733-035206_0_2_0_2_75_000_200.png',
            'K-003483-025367-027733-035206_0_2_0_2_90_000_200.png',
            'K-003483-025469-028763-035206_0_2_0_2_70_000_200.png',
            'K-003483-025469-028763-035206_0_2_0_2_75_000_200.png',
            'K-003483-025469-028763-035206_0_2_0_2_90_000_200.png',
            'K-003483-025469-030308-035206_0_2_0_2_70_000_200.png',
            'K-003483-025469-030308-035206_0_2_0_2_75_000_200.png',
            'K-003483-025469-030308-035206_0_2_0_2_90_000_200.png']


file_list5 = ['K-001900-016548-019607-029451_0_2_0_2_70_000_200.png',   # 1번
            'K-001900-016548-019607-029451_0_2_0_2_75_000_200.png',
            'K-001900-016548-019607-029451_0_2_0_2_90_000_200.png',
            'K-001900-016548-019607-033009_0_2_0_2_70_000_200.png',
            'K-001900-016548-019607-033009_0_2_0_2_75_000_200.png',
            'K-001900-016548-019607-033009_0_2_0_2_90_000_200.png',
            'K-001900-016548-021771-027926_0_2_0_2_70_000_200.png',
            'K-001900-016548-021771-027926_0_2_0_2_75_000_200.png',
            'K-001900-016548-021771-027926_0_2_0_2_90_000_200.png',
            'K-001900-016548-024850-029345_0_2_0_2_70_000_200.png',
            'K-001900-016548-024850-029345_0_2_0_2_75_000_200.png',
            'K-001900-016548-024850-029345_0_2_0_2_90_000_200.png',
            'K-001900-016551-029345-033208_0_2_0_2_70_000_200.png',
            'K-001900-016551-029345-033208_0_2_0_2_75_000_200.png',
            'K-001900-016551-029345-033208_0_2_0_2_90_000_200.png',
            'K-003351-003832-016232_0_2_0_2_75_000_200.png',
            'K-003351-003832-016232_0_2_0_2_90_000_200.png',
            'K-003351-003832-016262_0_2_0_2_70_000_200.png',
            'K-003351-003832-016262_0_2_0_2_75_000_200.png',
            'K-003351-003832-016262_0_2_0_2_90_000_200.png',
            'K-003351-003832-016688_0_2_0_2_70_000_200.png',
            'K-003351-003832-020238_0_2_0_2_90_000_200.png',
            'K-003351-003832-021325_0_2_0_2_70_000_200.png',
            'K-003351-003832-021325_0_2_0_2_75_000_200.png',
            'K-003351-003832-021325_0_2_0_2_90_000_200.png',
            'K-003351-003832-022074_0_2_0_2_70_000_200.png',
            'K-003351-003832-022074_0_2_0_2_75_000_200.png',
            'K-003351-003832-022074_0_2_0_2_90_000_200.png',
            'K-003351-003832-029667_0_2_0_2_75_000_200.png',
            'K-003351-003832-035206_0_2_0_2_70_000_200.png',
            'K-003351-003832-035206_0_2_0_2_75_000_200.png',
            'K-003351-003832-035206_0_2_0_2_90_000_200.png',
            'K-003351-003832-036637_0_2_0_2_90_000_200.png',
            'K-003351-003832-038162_0_2_0_2_70_000_200.png',
            'K-003351-003832-038162_0_2_0_2_75_000_200.png',
            'K-003351-013900-020238_0_2_0_2_90_000_200.png',
            'K-003351-013900-021325_0_2_0_2_70_000_200.png',
            'K-003351-013900-021325_0_2_0_2_75_000_200.png',
            'K-003351-013900-021325_0_2_0_2_90_000_200.png',
            'K-003351-013900-022074_0_2_0_2_70_000_200.png',
            'K-003351-013900-022074_0_2_0_2_75_000_200.png',
            'K-003351-013900-022074_0_2_0_2_90_000_200.png',
            'K-003351-013900-029667_0_2_0_2_70_000_200.png',
            'K-003351-013900-029667_0_2_0_2_90_000_200.png',
            'K-003351-013900-035206_0_2_0_2_70_000_200.png',
            'K-003351-013900-036637_0_2_0_2_70_000_200.png',
            'K-003351-013900-036637_0_2_0_2_75_000_200.png',
            'K-003351-013900-038162_0_2_0_2_70_000_200.png',
            'K-003351-013900-038162_0_2_0_2_75_000_200.png',
            'K-003351-013900-038162_0_2_0_2_90_000_200.png',
            'K-003351-016232-018357_0_2_0_2_75_000_200.png',
            'K-003351-016232-019232_0_2_0_2_70_000_200.png',
            'K-003351-016232-019232_0_2_0_2_75_000_200.png',
            'K-003351-016232-019232_0_2_0_2_90_000_200.png',
            'K-003351-016232-020014_0_2_0_2_75_000_200.png',
            'K-003351-016232-020014_0_2_0_2_90_000_200.png',
            'K-003351-016232-031863_0_2_0_2_90_000_200.png',
            'K-003351-016232-032310_0_2_0_2_90_000_200.png',
            'K-003351-016232-033880_0_2_0_2_75_000_200.png',
            'K-003351-016232-041768_0_2_0_2_70_000_200.png',
            'K-003351-016262-018147_0_2_0_2_75_000_200.png',
            'K-003351-016262-018147_0_2_0_2_90_000_200.png',
            'K-003351-016262-018357_0_2_0_2_75_000_200.png',
            'K-003351-016262-018357_0_2_0_2_90_000_200.png',
            'K-003351-016262-019232_0_2_0_2_90_000_200.png',
            'K-003351-016262-020014_0_2_0_2_70_000_200.png',
            'K-003351-016262-020014_0_2_0_2_75_000_200.png',
            'K-003351-016262-020014_0_2_0_2_90_000_200.png',
            'K-003351-016262-031863_0_2_0_2_70_000_200.png',
            'K-003351-016262-032310_0_2_0_2_75_000_200.png',
            'K-003351-016262-033880_0_2_0_2_75_000_200.png',
            'K-003351-016262-033880_0_2_0_2_90_000_200.png',
            'K-003351-016262-041768_0_2_0_2_70_000_200.png',
            'K-003351-016262-041768_0_2_0_2_75_000_200.png',
            'K-003351-016688-018147_0_2_0_2_70_000_200.png',
            'K-003351-016688-018147_0_2_0_2_75_000_200.png',
            'K-003351-016688-019232_0_2_0_2_90_000_200.png',
            'K-003351-016688-020014_0_2_0_2_90_000_200.png',
            'K-003351-016688-041768_0_2_0_2_90_000_200.png',
            'K-003351-018147-020238_0_2_0_2_75_000_200.png',
            'K-003351-018147-021325_0_2_0_2_90_000_200.png',
            'K-003351-018147-022074_0_2_0_2_90_000_200.png',
            'K-003351-018147-029667_0_2_0_2_70_000_200.png',
            'K-003351-018147-029667_0_2_0_2_75_000_200.png',
            'K-003351-018147-029667_0_2_0_2_90_000_200.png',
            'K-003351-018147-035206_0_2_0_2_70_000_200.png',
            'K-003351-018147-035206_0_2_0_2_90_000_200.png',
            'K-003351-018147-036637_0_2_0_2_70_000_200.png',
            'K-003351-018147-036637_0_2_0_2_90_000_200.png',
            'K-003351-018147-038162_0_2_0_2_75_000_200.png',
            'K-003351-018357-020238_0_2_0_2_70_000_200.png',
            'K-003351-018357-020238_0_2_0_2_75_000_200.png',
            'K-003351-018357-021325_0_2_0_2_70_000_200.png',
            'K-003351-018357-021325_0_2_0_2_90_000_200.png',
            'K-003351-018357-022074_0_2_0_2_90_000_200.png',
            'K-003351-018357-036637_0_2_0_2_75_000_200.png',
            'K-003351-018357-036637_0_2_0_2_90_000_200.png',
            'K-003351-018357-038162_0_2_0_2_90_000_200.png',
            'K-003351-019232-021325_0_2_0_2_75_000_200.png',
            'K-003351-019232-021325_0_2_0_2_90_000_200.png',
            'K-003351-019232-022074_0_2_0_2_70_000_200.png',
            'K-003351-019232-029667_0_2_1_2_70_000_200.png',
            'K-003351-019232-029667_0_2_1_2_90_000_200.png',
            'K-003351-019232-035206_0_2_0_2_75_000_200.png',
            'K-003351-019232-035206_0_2_0_2_90_000_200.png',
            'K-003351-019232-036637_0_2_0_2_70_000_200.png',
            'K-003351-019232-036637_0_2_0_2_90_000_200.png',
            'K-003351-019232-038162_0_2_0_2_70_000_200.png',
            'K-003351-019232-038162_0_2_0_2_75_000_200.png',
            'K-003351-019232-038162_0_2_0_2_90_000_200.png',
            'K-003351-020014-020238_0_2_0_2_75_000_200.png',
            'K-003351-020014-020238_0_2_0_2_90_000_200.png',
            'K-003351-020014-021325_0_2_0_2_90_000_200.png',
            'K-003351-020014-022074_0_2_0_2_70_000_200.png',
            'K-003351-020014-022074_0_2_0_2_90_000_200.png',
            'K-003351-020014-035206_0_2_0_2_70_000_200.png',
            'K-003351-020014-035206_0_2_0_2_75_000_200.png',
            'K-003351-020014-035206_0_2_0_2_90_000_200.png',
            'K-003351-020014-036637_0_2_1_2_75_000_200.png',
            'K-003351-020014-036637_0_2_1_2_90_000_200.png',
            'K-003351-020014-038162_0_2_0_2_70_000_200.png',
            'K-003351-020238-031863_0_2_0_2_70_000_200.png',
            'K-003351-020238-031863_0_2_0_2_90_000_200.png',
            'K-003351-020238-032310_0_2_0_2_70_000_200.png',
            'K-003351-020238-032310_0_2_0_2_90_000_200.png',
            'K-003351-020238-033880_0_2_0_2_75_000_200.png',
            'K-003351-020238-041768_0_2_0_2_75_000_200.png',
            'K-003351-020238-041768_0_2_0_2_90_000_200.png',
            'K-003351-021325-031863_0_2_0_2_70_000_200.png',
            'K-003351-021325-031863_0_2_0_2_75_000_200.png',
            'K-003351-021325-032310_0_2_0_2_75_000_200.png',
            'K-003351-021325-032310_0_2_0_2_90_000_200.png',
            'K-003351-021325-033880_0_2_0_2_70_000_200.png',
            'K-003351-021325-033880_0_2_0_2_75_000_200.png',
            'K-003351-021325-033880_0_2_0_2_90_000_200.png',
            'K-003351-021325-041768_0_2_0_2_70_000_200.png',
            'K-003351-021325-041768_0_2_0_2_75_000_200.png',
            'K-003351-021325-041768_0_2_0_2_90_000_200.png',
            'K-003351-022074-031863_0_2_0_2_75_000_200.png',
            'K-003351-022074-032310_0_2_0_2_75_000_200.png',
            'K-003351-022074-033880_0_2_0_2_70_000_200.png',
            'K-003351-022074-033880_0_2_0_2_75_000_200.png',
            'K-003351-022074-033880_0_2_0_2_90_000_200.png',
            'K-003351-029667-031863_0_2_0_2_70_000_200.png',
            'K-003351-029667-031863_0_2_0_2_75_000_200.png',
            'K-003351-029667-032310_0_2_0_2_70_000_200.png',
            'K-003351-029667-032310_0_2_0_2_90_000_200.png',
            'K-003351-029667-033880_0_2_0_2_70_000_200.png',
            'K-003351-029667-033880_0_2_0_2_90_000_200.png',
            'K-003351-029667-041768_0_2_0_2_90_000_200.png',
            'K-003351-031863-038162_0_2_0_2_70_000_200.png',
            'K-003351-032310-035206_0_2_0_2_75_000_200.png',
            'K-003351-032310-035206_0_2_0_2_90_000_200.png',
            'K-003351-032310-036637_0_2_0_2_70_000_200.png',
            'K-003351-032310-036637_0_2_0_2_90_000_200.png',
            'K-003351-032310-038162_0_2_0_2_70_000_200.png',
            'K-003351-032310-038162_0_2_0_2_90_000_200.png',
            'K-003351-033880-035206_0_2_0_2_75_000_200.png',
            'K-003351-033880-035206_0_2_0_2_90_000_200.png',
            'K-003351-033880-036637_0_2_0_2_75_000_200.png',
            'K-003351-033880-038162_0_2_0_2_70_000_200.png',
            'K-003351-033880-038162_0_2_0_2_75_000_200.png',
            'K-003351-035206-041768_0_2_0_2_70_000_200.png',
            'K-003351-035206-041768_0_2_0_2_90_000_200.png',
            'K-003351-036637-041768_0_2_0_2_70_000_200.png',
            'K-003351-036637-041768_0_2_0_2_90_000_200.png',
            'K-003351-038162-041768_0_2_0_2_70_000_200.png',
            'K-003351-038162-041768_0_2_0_2_75_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_70_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_75_000_200.png',
            'K-003483-016232-020877-030308_0_2_0_2_90_000_200.png',
            'K-003483-016232-020877-034597_0_2_0_2_70_000_200.png',
            'K-003483-016232-020877-034597_0_2_0_2_75_000_200.png',
            'K-003483-016232-020877-034597_0_2_0_2_90_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_70_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_75_000_200.png',
            'K-003483-016232-022347-025469_0_2_0_2_90_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_70_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_75_000_200.png',
            'K-003483-016262-019861-028763_0_2_0_2_90_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_70_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_75_000_200.png',
            'K-003483-016262-022347-027733_0_2_0_2_90_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_70_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_75_000_200.png',
            'K-003483-019861-020238-030308_0_2_0_2_90_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_70_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_75_000_200.png',
            'K-003483-020238-027733-028763_0_2_0_2_90_000_200.png',
            'K-003483-020877-031885-036637_0_2_0_2_70_000_200.png',
            'K-003483-020877-031885-036637_0_2_0_2_75_000_200.png',
            'K-003483-020877-031885-036637_0_2_0_2_90_000_200.png',
            'K-003483-025367-027733-029667_0_2_0_2_70_000_200.png',
            'K-003483-025367-027733-029667_0_2_0_2_75_000_200.png',
            'K-003483-025367-027733-029667_0_2_0_2_90_000_200.png',
            'K-003544-004543-012247-016548_0_2_0_2_70_000_200.png',
            'K-003544-004543-012247-016548_0_2_0_2_75_000_200.png',
            'K-003544-004543-012247-016548_0_2_0_2_90_000_200.png',
            'K-003544-004543-016548-027993_0_2_0_2_70_000_200.png',
            'K-003544-004543-016548-027993_0_2_0_2_75_000_200.png',
            'K-003544-004543-016548-027993_0_2_0_2_90_000_200.png']


data_maker(image_dir,anntation_dir,img_train_dir, label_train_dir,transforms, file_list1, 10)
data_maker(image_dir,anntation_dir,img_train_dir, label_train_dir,transforms, file_list2, 4)
data_maker(image_dir,anntation_dir,img_train_dir, label_train_dir,transforms, file_list3, 3)
data_maker(image_dir,anntation_dir,img_train_dir, label_train_dir,transforms, file_list4, 2)
data_maker(image_dir,anntation_dir,img_train_dir, label_train_dir,transforms, file_list5, 1)
"""


##### YOLO 4번 데이터 생성 예제 코드
"""
from make_YOLO_annotation import make_YOLO_annotation
from yolo_data_split import split_yolo_dataset
from class_mapping import read_classID
from yolo_get_file_name_list import get_file_name_YOLO
from YOLO_data_maker2 import data_maker2
import os

master_dir = r"C:\Users\User1\Downloads\ai-07-object-detection\sprint_ai_project1_data"     #   <-- 마스터 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")                              #   <-- 마스터 경로 아래 json 폴더 이름
image_dir = os.path.join(master_dir, r"train_images")                                       #   <-- 마스터 경로 아래 이미지 폴더 이름

class_dict = read_classID(anntation_dir)                                                    #       <-- annotation_dir의 ClassID.txt 파일

a_list = None
a_list = get_file_name_YOLO(anntation_dir,image_dir, -8)                                        #   <-- a_list(valid 데이터 이름 리스트를 가져옴)


yolo_annotation_dir = make_YOLO_annotation(image_dir, anntation_dir, class_dict, "YOLO_annotation_file")    #   <-- yolo annotation 파일 생성. 생성된 폴더 경로를 반환 (anntation_dir 아래 YOLO_annotation_file 이름으로 파일이 생성됩니다.)

split_yolo_dataset(
        image_dir=image_dir,                    #   <-- 원본 이미지 폴더
        anntation_dir=yolo_annotation_dir,      #   <-- 원본 annotation(txt) 폴더
        output_dir=master_dir,                  #   <-- 결과 저장 폴더
        val_ratio=0.2,                           #   <-- train 80% valid 20%
        file_name_list=a_list                   #   <-- Valid 파일 이름 리스트
)

img_dir = os.path.join(master_dir, r"images", r"train")    #   <-- split된 image\train 폴더
txt_dir = os.path.join(master_dir, r"labels", r"train")    #   <-- split된 labels\train 폴더

class_list1 = [29451, 33009, 21771, 27926, 24850, 16551, 33208, 3743, 13395, 12081, 19552, 22362, 34597, 31885, 27777, 12247, 27993]         #--> 전체 클래스 수: 3
class_list2 = [19607, 29345, 12778, 2543, 19861, 3544, 4543, 25438]    #--> 전체 클래스 수: 6
class_list3 = [16688]                                           #--> 전체 클래스 수: 8
class_list4 = [2483, 30308, 22347, 28763]                       #--> 전체 클래스 수: 9
class_list5 = [18357, 31863, 20877, 25469, 27733, 25367]        #--> 전체 클래스 수: 12
class_list6 = [32310, 1900, 13900, 18147, 22074, 41768, 20014, 33880, 16548, 29667, 38162, 19232, 36637, 3832, 20238, 16232, 21325, 16262]  #--> 전체 클래스 수: 15 ~ 23

data_maker2(img_dir, txt_dir, class_dict, class_list1, 0, 30, file_name="cls_list1_augmentation")       # 30개 추가 생성
data_maker2(img_dir, txt_dir, class_dict, class_list2, 0, 25, file_name="cls_list2_augmentation")       # 25개 추가 생성
data_maker2(img_dir, txt_dir, class_dict, class_list3, 0, 25, file_name="cls_list3_augmentation")       # 25개 추가 생성
data_maker2(img_dir, txt_dir, class_dict, class_list4, 0, 25, file_name="cls_list4_augmentation")       # 25개 추가 생성
data_maker2(img_dir, txt_dir, class_dict, class_list5, 0, 20, file_name="cls_list5_augmentation")       # 20개 추가 생성
data_maker2(img_dir, txt_dir, class_dict, class_list6, 0, 10, file_name="cls_list6_augmentation")       # 10개 추가 생성
"""