# Faster_RCNN:

필요 파일:
Faster_RCNN_dataset.py
Faster_RCNN_dataloader.py


Faster_RCNN_dataset.py 클래스 목록:
- class FasterRCNNDataset(Dataset):     __init__(self, img_dir, annt_dir, transforms=training_transforms):
- class TestDataset(Dataset):           __init__(self, img_dir, transforms=training_transforms, load_exts = ("*.jpg", "*.png", "*.jpeg")):


Faster_RCNN_dataloader.py 함수 목록:
- def train_valid_build_dataloaders(train_dataset, valid_dataset, batch_size, num_workers=0, shuffle=True, valid_shuffle=False):    return train_loader, valid_loader
- def full_train_build_dataloaders(train_dataset, batch_size, num_workers=0, shuffle=True):                                         return train_loader
- def test_build_dataloaders(test_dataset, batch_size, num_workers=0, shuffle=False):                                               return test_loader


예제 코드:
"""
import os

from Faster_RCNN_dataset import FasterRCNNDataset
from Faster_RCNN_dataset import TestDataset

import Faster_RCNN_dataloader

master_dir = r"ai-07-object-detection\sprint_ai_project1_data"              #   <-- 마스터 경로 입력
test_dir = r"ai-07-object-detection\sprint_ai_project1_data\test_images"    #   <-- 테스트 이미지 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")              #   <-- 마스터 경로 아래 json 폴더 이름
image_dir = os.path.join(master_dir, r"train_images")                       #   <-- 마스터 경로 아래 이미지 폴더 이름


fast_dataset = FasterRCNNDataset(image_dir, anntation_dir)                  #   <-- train 데이터 class 객체 생성
test_dataset = TestDataset(test_dir)                                        #   <-- test 데이터 class 객체 생성

full_dataloader = Faster_RCNN_dataloader.full_train_build_dataloaders(fast_dataset,4)   #   <-- 데이터 로더 생성
"""



# YOLO:

필요 파일:
make_YOLO_annotation.py
yolo_data_split.py



make_YOLO_annotation.py 함수 목록:
make_YOLO_annotation(image_dir, anntation_dir, folder_name="YOLO annotation", load_exts = ("*.jpg", "*.png", "*.jpeg")):                    return YOLO_annt_dir


yolo_data_split.py 함수 목록:
split_yolo_dataset(image_dir, anntation_dir, output_dir, val_ratio=0.2, seed=42, shuffle=True, image_exts=(".jpg", ".jpeg", ".png")):       return None


예제 코드:
"""
from make_YOLO_annotation import make_YOLO_annotation
from make_YOLO_folder import mk_YOLO_dir
from yolo_data_split import split_yolo_dataset

import os

master_dir = r"ai-07-object-detection\sprint_ai_project1_data"     #   <-- 마스터 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")                              #   <-- 마스터 경로 아래 json 폴더 이름                              
image_dir = os.path.join(master_dir, r"train_images")                                       #   <-- 마스터 경로 아래 이미지 폴더 이름

yolo_annotation_dir = make_YOLO_annotation(image_dir, anntation_dir, "YOLO_annotation_file")    #   <-- yolo annotation 파일 생성. 생성된 폴더 경로를 반환 (anntation_dir 아래 YOLO_annotation_file 이름으로 파일이 생성됩니다.)

split_yolo_dataset(
        image_dir=image_dir,                    #   <-- 원본 이미지 폴더
        anntation_dir=yolo_annotation_dir,      #   <-- 원본 annotation(txt) 폴더
        output_dir=master_dir,                  #   <-- 결과 저장 폴더
        val_ratio=0.2                           #   <-- train 80% valid 20%
)
"""