# Faster_RCNN:

필요 파일:
Faster_RCNN_dataset.py
Faster_RCNN_dataloader.py
make_classID_txt.py


Faster_RCNN_dataset.py 클래스 목록:
- class FasterRCNNDataset(Dataset):     __init__(self, img_dir, annt_dir, transforms=training_transforms):
- class TestDataset(Dataset):           __init__(self, img_dir, transforms=training_transforms, load_exts = ("*.jpg", "*.png", "*.jpeg")):


Faster_RCNN_dataloader.py 함수 목록:
- def train_valid_build_dataloaders(train_dataset, valid_dataset, batch_size, num_workers=0, shuffle=True, valid_shuffle=False):    return train_loader, valid_loader
- def full_train_build_dataloaders(train_dataset, batch_size, num_workers=0, shuffle=True):                                         return train_loader
- def test_build_dataloaders(test_dataset, batch_size, num_workers=0, shuffle=False):                                               return test_loader


예제 코드:
"""
import os
from Faster_RCNN_dataset import FasterRCNNDataset
from Faster_RCNN_dataset import TestDataset
import Faster_RCNN_dataloader
from sklearn.model_selection import train_test_split
import glob
from make_classID_txt import make_classIDtxt
from class_mapping import read_classID


master_dir = r"ai-07-object-detection\sprint_ai_project1_data"              #   <-- 마스터 경로 입력
test_dir = r"ai-07-object-detection\sprint_ai_project1_data\test_images"    #   <-- 테스트 이미지 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")              #   <-- 마스터 경로 아래 json 폴더 이름
image_dir = os.path.join(master_dir, r"train_images")                       #   <-- 마스터 경로 아래 이미지 폴더 이름

class_dict = read_classID(anntation_dir)        #       <-- annotation_dir의 ClassID.txt 파일

fast_dataset = FasterRCNNDataset(image_dir, anntation_dir, class_dict)                  #   <-- train 데이터 class 객체 생성
test_dataset = TestDataset(test_dir)                                        #   <-- test 데이터 class 객체 생성

full_dataloader = Faster_RCNN_dataloader.full_train_build_dataloaders(fast_dataset,4)   #   <-- 데이터 로더 생성


img_path_list = glob.glob(os.path.join(image_dir, "**"), recursive=True)    #   split 모드 <-- 이미지 경로 리스트를 받아 dataset 생성
train_imgs_path, val_imgs_path = train_test_split(img_path_list, test_size=0.2, random_state=42, shuffle=True)

train_dataset = FasterRCNNDataset(image_dir, anntation_dir, class_dict, img_path_list_mode=True, img_path_list=train_imgs_path)   #   img_path_list_mode == 이미지 경로 리스트 형태로 받음
valid_dataset = FasterRCNNDataset(image_dir, anntation_dir, class_dict, img_path_list_mode=True, img_path_list=val_imgs_path)

print(len(train_dataset), len(valid_dataset))

train_dataloader = Faster_RCNN_dataloader.full_train_build_dataloaders(train_dataset,4)
valid_dataloader = Faster_RCNN_dataloader.full_train_build_dataloaders(valid_dataset,4)
"""



# YOLO:

필요 파일:
make_YOLO_annotation.py
yolo_data_split.py



make_YOLO_annotation.py 함수 목록:
make_YOLO_annotation(image_dir, anntation_dir, folder_name="YOLO annotation", load_exts = ("*.jpg", "*.png", "*.jpeg")):                    return YOLO_annt_dir


yolo_data_split.py 함수 목록:
split_yolo_dataset(image_dir, anntation_dir, output_dir, val_ratio=0.2, seed=42, shuffle=True, image_exts=(".jpg", ".jpeg", ".png")):       return None


예제 코드:
"""
from make_YOLO_annotation import make_YOLO_annotation
from yolo_data_split import split_yolo_dataset
from class_mapping import read_classID

import os

master_dir = r"ai-07-object-detection\sprint_ai_project1_data"     #   <-- 마스터 경로 입력

anntation_dir = os.path.join(master_dir, r"train_annotations")                              #   <-- 마스터 경로 아래 json 폴더 이름                              
image_dir = os.path.join(master_dir, r"train_images")                                       #   <-- 마스터 경로 아래 이미지 폴더 이름

class_dict = read_classID(anntation_dir)                                                    #       <-- annotation_dir의 ClassID.txt 파일

yolo_annotation_dir = make_YOLO_annotation(image_dir, anntation_dir, class_dict, "YOLO_annotation_file")    #   <-- yolo annotation 파일 생성. 생성된 폴더 경로를 반환 (anntation_dir 아래 YOLO_annotation_file 이름으로 파일이 생성됩니다.)

split_yolo_dataset(
        image_dir=image_dir,                    #   <-- 원본 이미지 폴더
        anntation_dir=yolo_annotation_dir,      #   <-- 원본 annotation(txt) 폴더
        output_dir=master_dir,                  #   <-- 결과 저장 폴더
        val_ratio=0.2                           #   <-- train 80% valid 20%
)
"""