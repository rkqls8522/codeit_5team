#======================================================================================
# YOLO 실험 4번: 데이터 준비 및 증강 전용 스크립트
# - 원본 데이터로부터 YOLO annotation 생성
# - train/val 분할 후 experiment4 폴더에 복사
# - RandomAdjustSharpness(factor=50.0) 변환으로 선택된 파일들에 대해 증강 데이터 생성
# - 이 스크립트는 한 번만 실행하면 됨
#======================================================================================
import os
import sys
import yaml
import shutil
from torchvision.transforms import v2

# 프로젝트 루트 경로 찾기
CURRENT_DIR = os.path.dirname(os.path.abspath(__file__))
ROOT_DIR = os.path.dirname(os.path.dirname(os.path.dirname(CURRENT_DIR)))

# data_engineer 모듈 경로 추가
DATA_ENGINEER_DIR = os.path.join(ROOT_DIR, 'src', 'data_engineer')
sys.path.insert(0, DATA_ENGINEER_DIR)

# data_engineer 모듈 임포트
try:
    from make_YOLO_annotation import make_YOLO_annotation
    from yolo_data_split import split_yolo_dataset
    from class_mapping import read_classID
    from yolo_get_file_name_list import get_file_name_YOLO
    from YOLO_data_maker import data_maker
    print("data_engineer 모듈 로드 성공")
except ImportError as e:
    print(f"data_engineer 모듈 로드 실패: {e}")
    sys.exit(1)

def prepare_experiment4_data():
    """
    YOLO 실험 4번을 위한 데이터 준비 (원본 + 선명도 향상 데이터)
    
    실행 단계:
    1. 원본 데이터 로드 및 YOLO annotation 생성
    2. Train/Val 데이터 분할 (8:2)
    3. experiment4 폴더 생성 및 원본 데이터 복사
    4. 선명도 향상 변환 적용하여 증강 데이터 생성
    5. data_experiment4.yaml 파일 생성
    
    Returns:
        str: experiment4 디렉토리 경로 (성공 시) 또는 None (실패 시)
    """
    print("\n" + "="*80)
    print("[YOLO 실험 4번] 데이터 준비 및 증강 시작")
    print("="*80 + "\n")
    
    # ============================================================================
    # [1단계] 원본 데이터 경로 설정 및 확인
    # ============================================================================
    master_dir = os.path.join(ROOT_DIR, 'data', 'original')
    image_dir = os.path.join(master_dir, "images", "train")
    annotation_dir = os.path.join(master_dir, "train_annotations")
    
    print("="*80)
    print(f"▶ [1단계] 원본 데이터 경로 확인")
    print(f" - Image 경로: {os.path.abspath(image_dir)}")
    print(f" - Annotation 경로: {os.path.abspath(annotation_dir)}")
    print("="*80 + "\n")
    
    if not os.path.exists(annotation_dir):
        print(f"경고: 어노테이션 폴더를 찾을 수 없습니다: {annotation_dir}")
        return None
    
    # ============================================================================
    # [2단계] ClassID 로드 - 클래스 정보 읽기
    # ============================================================================
    try:
        class_dict = read_classID(DATA_ENGINEER_DIR)
    except Exception as e:
        print(f"ClassID 로드 실패: {e}")
        return None
    
    # ============================================================================
    # [3단계] YOLO 어노테이션 생성 및 데이터 분할
    # ============================================================================
    # 임시 데이터셋 저장 경로 (train/val 분할용)
    temp_split_dir = os.path.join(ROOT_DIR, 'data', 'yolo_dataset_temp')
    
    print("="*80)
    print(f"▶ [2단계] YOLO 어노테이션 생성 및 데이터 분할")
    print(f" - 임시 저장 경로: {os.path.abspath(temp_split_dir)}")
    print("="*80 + "\n")
    
    # YOLO 어노테이션 생성
    print("YOLO 어노테이션 생성 중...")
    yolo_annt_dir = make_YOLO_annotation(image_dir, annotation_dir, class_dict, "YOLO_annotation_exp4")
    
    # valid 파일 리스트 가져오기
    a_list = get_file_name_YOLO(annotation_dir, image_dir, -8)
    
    # Train/Val 분할 (임시 폴더에)
    print("Train/Val 데이터 분할 중 (8:2)...")
    split_yolo_dataset(
        image_dir=image_dir,
        anntation_dir=yolo_annt_dir,
        output_dir=temp_split_dir,
        val_ratio=0.2,
        file_name_list=a_list
    )
    
    # ============================================================================
    # [4단계] experiment4 폴더 생성 및 원본 데이터 복사
    # ============================================================================
    experiment4_dir = os.path.join(ROOT_DIR, 'data', 'yolo_dataset', 'experiment4')
    
    print("\n" + "="*80)
    print(f"▶ [3단계] experiment4 폴더 생성 및 원본 데이터 복사")
    print(f" - experiment4 경로: {os.path.abspath(experiment4_dir)}")
    print("="*80 + "\n")
    
    # experiment4 폴더가 이미 있으면 삭제
    if os.path.exists(experiment4_dir):
        print(f"기존 experiment4 폴더 삭제 중...")
        shutil.rmtree(experiment4_dir)
    
    # 임시 폴더의 모든 데이터를 experiment4로 복사
    print("원본 train/val 데이터를 experiment4 폴더로 복사 중...")
    shutil.copytree(temp_split_dir, experiment4_dir)
    print(f"✓ 복사 완료: {temp_split_dir} → {experiment4_dir}")
    
    # 임시 폴더 삭제
    print("임시 폴더 삭제 중...")
    shutil.rmtree(temp_split_dir)
    print("✓ 임시 폴더 삭제 완료\n")
    
    # ============================================================================
    # [5단계] data.yaml 생성
    # ============================================================================
    print("="*80)
    print(f"▶ [4단계] data.yaml 생성")
    print("="*80 + "\n")
    
    # YOLO용 names 딕셔너리 생성
    yolo_names = {}
    for v in class_dict.values():
        yolo_names[v['yolo_id']] = v['name']
    
    # yaml 설정
    data_config = {
        'path': experiment4_dir,
        'train': 'images/train',
        'val': 'images/val',
        'nc': len(yolo_names),
        'names': yolo_names
    }
    
    # data.yaml 저장 (model/yolo 폴더에)
    model_yolo_dir = os.path.join(ROOT_DIR, 'src', 'model', 'yolo')
    data_yaml_path = os.path.join(model_yolo_dir, 'data_experiment4.yaml')
    with open(data_yaml_path, 'w', encoding='utf-8') as f:
        yaml.dump(data_config, f, allow_unicode=True, sort_keys=False)
    
    print(f"✓ data.yaml 생성 완료: {data_yaml_path}")
    print(f"  - Classes: {len(yolo_names)}")
    print(f"  - Path: {experiment4_dir}\n")
    
    # ============================================================================
    # [6단계] 증강 데이터 생성 - 선명도 향상 적용
    # ============================================================================
    print("="*80)
    print(f"▶ [5단계] 증강 데이터 생성 (선명도 향상: factor=50.0)")
    print("="*80 + "\n")
    
    img_train_dir = os.path.join(experiment4_dir, "images", "train")
    label_train_dir = os.path.join(experiment4_dir, "labels", "train")
    
    # 선명도 향상 transform 정의
    # sharpness_factor=50.0: 매우 강한 선명도 향상
    # p=1.0: 100% 확률로 적용
    transforms = v2.Compose([
        v2.RandomAdjustSharpness(sharpness_factor=50.0, p=1.0)
    ])
    
    # 데이터 실험.md의 파일 리스트 정의
    # experiment3과 동일한 파일 리스트 사용
    
    # file_list1: 10번 증강 (37개 파일)
    file_list1 = ['K-001900-016548-019607-029451_0_2_0_2_70_000_200.png',
                'K-001900-016548-019607-029451_0_2_0_2_75_000_200.png',
                'K-001900-016548-019607-029451_0_2_0_2_90_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_70_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_75_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_90_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_70_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_75_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_90_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_70_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_75_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_90_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_70_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_75_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_90_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_70_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_75_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_90_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_70_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_75_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_90_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_70_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_75_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_90_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_70_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_75_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_90_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_70_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_75_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_90_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_70_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_75_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_90_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_70_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_75_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_90_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_70_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_75_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_90_000_200.png']
    
    # file_list2: 4번 증강 (37개 파일)
    file_list2 = ['K-001900-016548-019607-029451_0_2_0_2_70_000_200.png',
                'K-001900-016548-019607-029451_0_2_0_2_75_000_200.png',
                'K-001900-016548-019607-029451_0_2_0_2_90_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_70_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_75_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_90_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_70_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_75_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_90_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_70_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_75_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_90_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_70_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_75_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_90_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_70_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_75_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_90_000_200.png',
                'K-003351-003832-016688_0_2_0_2_70_000_200.png',
                'K-003351-016688-018147_0_2_0_2_70_000_200.png',
                'K-003351-016688-018147_0_2_0_2_75_000_200.png',
                'K-003351-016688-018357_0_2_0_2_75_000_200.png',
                'K-003351-016688-019232_0_2_0_2_90_000_200.png',
                'K-003351-016688-020014_0_2_0_2_90_000_200.png',
                'K-003351-016688-031863_0_2_0_2_90_000_200.png',
                'K-003351-016688-041768_0_2_0_2_90_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_70_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_75_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_90_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_70_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_75_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_90_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_70_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_75_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_90_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_70_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_75_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_90_000_200.png']
    
    # file_list3: 3번 증강 (36개 파일)
    file_list3 = ['K-002483-003743-012778-013395_0_2_0_2_70_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_75_000_200.png',
                'K-002483-003743-012778-013395_0_2_0_2_90_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_70_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_75_000_200.png',
                'K-002483-012081-012778-025438_0_2_0_2_90_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_70_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_75_000_200.png',
                'K-002483-019552-022362-025438_0_2_0_2_90_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_70_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_75_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_90_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_70_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_75_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_90_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_70_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_75_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_90_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_70_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_75_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_90_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_70_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_75_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_90_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_70_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_75_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_90_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_70_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_75_000_200.png',
                'K-003483-022347-027777-035206_0_2_0_2_90_000_200.png',
                'K-003483-025469-028763-035206_0_2_0_2_70_000_200.png',
                'K-003483-025469-028763-035206_0_2_0_2_75_000_200.png',
                'K-003483-025469-028763-035206_0_2_0_2_90_000_200.png',
                'K-003483-025469-030308-035206_0_2_0_2_70_000_200.png',
                'K-003483-025469-030308-035206_0_2_0_2_75_000_200.png',
                'K-003483-025469-030308-035206_0_2_0_2_90_000_200.png']
    
    # file_list4: 2번 증강 (60개 파일)
    file_list4 = ['K-003351-016232-018357_0_2_0_2_75_000_200.png',
                'K-003351-016232-031863_0_2_0_2_90_000_200.png',
                'K-003351-016262-018357_0_2_0_2_90_000_200.png',
                'K-003351-016262-031863_0_2_0_2_70_000_200.png',
                'K-003351-016688-018357_0_2_0_2_75_000_200.png',
                'K-003351-016688-031863_0_2_0_2_90_000_200.png',
                'K-003351-018357-020238_0_2_0_2_70_000_200.png',
                'K-003351-018357-020238_0_2_0_2_75_000_200.png',
                'K-003351-018357-021325_0_2_0_2_70_000_200.png',
                'K-003351-018357-021325_0_2_0_2_90_000_200.png',
                'K-003351-018357-022074_0_2_0_2_90_000_200.png',
                'K-003351-018357-035206_0_2_0_2_70_000_200.png',
                'K-003351-018357-036637_0_2_0_2_75_000_200.png',
                'K-003351-018357-036637_0_2_0_2_90_000_200.png',
                'K-003351-018357-038162_0_2_0_2_90_000_200.png',
                'K-003351-020238-031863_0_2_0_2_70_000_200.png',
                'K-003351-020238-031863_0_2_0_2_90_000_200.png',
                'K-003351-021325-031863_0_2_0_2_70_000_200.png',
                'K-003351-021325-031863_0_2_0_2_75_000_200.png',
                'K-003351-022074-031863_0_2_0_2_75_000_200.png',
                'K-003351-029667-031863_0_2_0_2_70_000_200.png',
                'K-003351-029667-031863_0_2_0_2_75_000_200.png',
                'K-003351-031863-035206_0_2_0_2_75_000_200.png',
                'K-003351-031863-038162_0_2_0_2_70_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_70_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_75_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_90_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_70_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_75_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_90_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_70_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_75_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_90_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_70_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_75_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_90_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_70_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_75_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_90_000_200.png',
                'K-003483-020877-025367-035206_0_2_0_2_70_000_200.png',
                'K-003483-020877-025367-035206_0_2_0_2_75_000_200.png',
                'K-003483-020877-025367-035206_0_2_0_2_90_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_70_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_75_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_90_000_200.png',
                'K-003483-025367-025469-035206_0_2_0_2_70_000_200.png',
                'K-003483-025367-025469-035206_0_2_0_2_75_000_200.png',
                'K-003483-025367-025469-035206_0_2_0_2_90_000_200.png',
                'K-003483-025367-027733-029667_0_2_0_2_70_000_200.png',
                'K-003483-025367-027733-029667_0_2_0_2_75_000_200.png',
                'K-003483-025367-027733-029667_0_2_0_2_90_000_200.png',
                'K-003483-025367-027733-035206_0_2_0_2_70_000_200.png',
                'K-003483-025367-027733-035206_0_2_0_2_75_000_200.png',
                'K-003483-025367-027733-035206_0_2_0_2_90_000_200.png',
                'K-003483-025469-028763-035206_0_2_0_2_70_000_200.png',
                'K-003483-025469-028763-035206_0_2_0_2_75_000_200.png',
                'K-003483-025469-028763-035206_0_2_0_2_90_000_200.png',
                'K-003483-025469-030308-035206_0_2_0_2_70_000_200.png',
                'K-003483-025469-030308-035206_0_2_0_2_75_000_200.png',
                'K-003483-025469-030308-035206_0_2_0_2_90_000_200.png']
    
    # file_list5는 너무 길어서 생략 (201개 파일) - experiment3에서 복사
    file_list5 = ['K-001900-016548-019607-029451_0_2_0_2_70_000_200.png',
                'K-001900-016548-019607-029451_0_2_0_2_75_000_200.png',
                'K-001900-016548-019607-029451_0_2_0_2_90_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_70_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_75_000_200.png',
                'K-001900-016548-019607-033009_0_2_0_2_90_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_70_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_75_000_200.png',
                'K-001900-016548-021771-027926_0_2_0_2_90_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_70_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_75_000_200.png',
                'K-001900-016548-024850-029345_0_2_0_2_90_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_70_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_75_000_200.png',
                'K-001900-016551-029345-033208_0_2_0_2_90_000_200.png',
                'K-003351-003832-016232_0_2_0_2_75_000_200.png',
                'K-003351-003832-016232_0_2_0_2_90_000_200.png',
                'K-003351-003832-016262_0_2_0_2_70_000_200.png',
                'K-003351-003832-016262_0_2_0_2_75_000_200.png',
                'K-003351-003832-016262_0_2_0_2_90_000_200.png',
                'K-003351-003832-016688_0_2_0_2_70_000_200.png',
                'K-003351-003832-020238_0_2_0_2_90_000_200.png',
                'K-003351-003832-021325_0_2_0_2_70_000_200.png',
                'K-003351-003832-021325_0_2_0_2_75_000_200.png',
                'K-003351-003832-021325_0_2_0_2_90_000_200.png',
                'K-003351-003832-022074_0_2_0_2_70_000_200.png',
                'K-003351-003832-022074_0_2_0_2_75_000_200.png',
                'K-003351-003832-022074_0_2_0_2_90_000_200.png',
                'K-003351-003832-029667_0_2_0_2_75_000_200.png',
                'K-003351-003832-035206_0_2_0_2_70_000_200.png',
                'K-003351-003832-035206_0_2_0_2_75_000_200.png',
                'K-003351-003832-035206_0_2_0_2_90_000_200.png',
                'K-003351-003832-036637_0_2_0_2_90_000_200.png',
                'K-003351-003832-038162_0_2_0_2_70_000_200.png',
                'K-003351-003832-038162_0_2_0_2_75_000_200.png',
                'K-003351-013900-020238_0_2_0_2_90_000_200.png',
                'K-003351-013900-021325_0_2_0_2_70_000_200.png',
                'K-003351-013900-021325_0_2_0_2_75_000_200.png',
                'K-003351-013900-021325_0_2_0_2_90_000_200.png',
                'K-003351-013900-022074_0_2_0_2_70_000_200.png',
                'K-003351-013900-022074_0_2_0_2_75_000_200.png',
                'K-003351-013900-022074_0_2_0_2_90_000_200.png',
                'K-003351-013900-029667_0_2_0_2_70_000_200.png',
                'K-003351-013900-029667_0_2_0_2_90_000_200.png',
                'K-003351-013900-035206_0_2_0_2_70_000_200.png',
                'K-003351-013900-036637_0_2_0_2_70_000_200.png',
                'K-003351-013900-036637_0_2_0_2_75_000_200.png',
                'K-003351-013900-038162_0_2_0_2_70_000_200.png',
                'K-003351-013900-038162_0_2_0_2_75_000_200.png',
                'K-003351-013900-038162_0_2_0_2_90_000_200.png',
                'K-003351-016232-018357_0_2_0_2_75_000_200.png',
                'K-003351-016232-019232_0_2_0_2_70_000_200.png',
                'K-003351-016232-019232_0_2_0_2_75_000_200.png',
                'K-003351-016232-019232_0_2_0_2_90_000_200.png',
                'K-003351-016232-020014_0_2_0_2_75_000_200.png',
                'K-003351-016232-020014_0_2_0_2_90_000_200.png',
                'K-003351-016232-031863_0_2_0_2_90_000_200.png',
                'K-003351-016232-032310_0_2_0_2_90_000_200.png',
                'K-003351-016232-033880_0_2_0_2_75_000_200.png',
                'K-003351-016232-041768_0_2_0_2_70_000_200.png',
                'K-003351-016262-018147_0_2_0_2_75_000_200.png',
                'K-003351-016262-018147_0_2_0_2_90_000_200.png',
                'K-003351-016262-018357_0_2_0_2_75_000_200.png',
                'K-003351-016262-018357_0_2_0_2_90_000_200.png',
                'K-003351-016262-019232_0_2_0_2_90_000_200.png',
                'K-003351-016262-020014_0_2_0_2_70_000_200.png',
                'K-003351-016262-020014_0_2_0_2_75_000_200.png',
                'K-003351-016262-020014_0_2_0_2_90_000_200.png',
                'K-003351-016262-031863_0_2_0_2_70_000_200.png',
                'K-003351-016262-032310_0_2_0_2_75_000_200.png',
                'K-003351-016262-033880_0_2_0_2_75_000_200.png',
                'K-003351-016262-033880_0_2_0_2_90_000_200.png',
                'K-003351-016262-041768_0_2_0_2_70_000_200.png',
                'K-003351-016262-041768_0_2_0_2_75_000_200.png',
                'K-003351-016688-018147_0_2_0_2_70_000_200.png',
                'K-003351-016688-018147_0_2_0_2_75_000_200.png',
                'K-003351-016688-019232_0_2_0_2_90_000_200.png',
                'K-003351-016688-020014_0_2_0_2_90_000_200.png',
                'K-003351-016688-041768_0_2_0_2_90_000_200.png',
                'K-003351-018147-020238_0_2_0_2_75_000_200.png',
                'K-003351-018147-021325_0_2_0_2_90_000_200.png',
                'K-003351-018147-022074_0_2_0_2_90_000_200.png',
                'K-003351-018147-029667_0_2_0_2_70_000_200.png',
                'K-003351-018147-029667_0_2_0_2_75_000_200.png',
                'K-003351-018147-029667_0_2_0_2_90_000_200.png',
                'K-003351-018147-035206_0_2_0_2_70_000_200.png',
                'K-003351-018147-035206_0_2_0_2_90_000_200.png',
                'K-003351-018147-036637_0_2_0_2_70_000_200.png',
                'K-003351-018147-036637_0_2_0_2_90_000_200.png',
                'K-003351-018147-038162_0_2_0_2_75_000_200.png',
                'K-003351-018357-020238_0_2_0_2_70_000_200.png',
                'K-003351-018357-020238_0_2_0_2_75_000_200.png',
                'K-003351018357-021325_0_2_0_2_70_000_200.png',
                'K-003351-018357-021325_0_2_0_2_90_000_200.png',
                'K-003351-018357-022074_0_2_0_2_90_000_200.png',
                'K-003351-018357-036637_0_2_0_2_75_000_200.png',
                'K-003351-018357-036637_0_2_0_2_90_000_200.png',
                'K-003351-018357-038162_0_2_0_2_90_000_200.png',
                'K-003351-019232-021325_0_2_0_2_75_000_200.png',
                'K-003351-019232-021325_0_2_0_2_90_000_200.png',
                'K-003351-019232-022074_0_2_0_2_70_000_200.png',
                'K-003351-019232-029667_0_2_1_2_70_000_200.png',
                'K-003351-019232-029667_0_2_1_2_90_000_200.png',
                'K-003351-019232-035206_0_2_0_2_75_000_200.png',
                'K-003351-019232-035206_0_2_0_2_90_000_200.png',
                'K-003351-019232-036637_0_2_0_2_70_000_200.png',
                'K-003351-019232-036637_0_2_0_2_90_000_200.png',
                'K-003351-019232-038162_0_2_0_2_70_000_200.png',
                'K-003351-019232-038162_0_2_0_2_75_000_200.png',
                'K-003351-019232-038162_0_2_0_2_90_000_200.png',
                'K-003351-020014-020238_0_2_0_2_75_000_200.png',
                'K-003351-020014-020238_0_2_0_2_90_000_200.png',
                'K-003351-020014-021325_0_2_0_2_90_000_200.png',
                'K-003351-020014-022074_0_2_0_2_70_000_200.png',
                'K-003351-020014-022074_0_2_0_2_90_000_200.png',
                'K-003351-020014-035206_0_2_0_2_70_000_200.png',
                'K-003351-020014-035206_0_2_0_2_75_000_200.png',
                'K-003351-020014-035206_0_2_0_2_90_000_200.png',
                'K-003351-020014-036637_0_2_1_2_75_000_200.png',
                'K-003351-020014-036637_0_2_1_2_90_000_200.png',
                'K-003351-020014-038162_0_2_0_2_70_000_200.png',
                'K-003351-020238-031863_0_2_0_2_70_000_200.png',
                'K-003351-020238-031863_0_2_0_2_90_000_200.png',
                'K-003351-020238-032310_0_2_0_2_70_000_200.png',
                'K-003351-020238-032310_0_2_0_2_90_000_200.png',
                'K-003351-020238-033880_0_2_0_2_75_000_200.png',
                'K-003351-020238-041768_0_2_0_2_75_000_200.png',
                'K-003351-020238-041768_0_2_0_2_90_000_200.png',
                'K-003351-021325-031863_0_2_0_2_70_000_200.png',
                'K-003351-021325-031863_0_2_0_2_75_000_200.png',
                'K-003351-021325-032310_0_2_0_2_75_000_200.png',
                'K-003351-021325-032310_0_2_0_2_90_000_200.png',
                'K-003351-021325-033880_0_2_0_2_70_000_200.png',
                'K-003351-021325-033880_0_2_0_2_75_000_200.png',
                'K-003351-021325-033880_0_2_0_2_90_000_200.png',
                'K-003351-021325-041768_0_2_0_2_70_000_200.png',
                'K-003351-021325-041768_0_2_0_2_75_000_200.png',
                'K-003351-021325-041768_0_2_0_2_90_000_200.png',
                'K-003351-022074-031863_0_2_0_2_75_000_200.png',
                'K-003351-022074-032310_0_2_0_2_75_000_200.png',
                'K-003351-022074-033880_0_2_0_2_70_000_200.png',
                'K-003351-022074-033880_0_2_0_2_75_000_200.png',
                'K-003351-022074-033880_0_2_0_2_90_000_200.png',
                'K-003351-029667-031863_0_2_0_2_70_000_200.png',
                'K-003351-029667-031863_0_2_0_2_75_000_200.png',
                'K-003351-029667-032310_0_2_0_2_70_000_200.png',
                'K-003351-029667-032310_0_2_0_2_90_000_200.png',
                'K-003351-029667-033880_0_2_0_2_70_000_200.png',
                'K-003351-029667-033880_0_2_0_2_90_000_200.png',
                'K-003351-029667-041768_0_2_0_2_90_000_200.png',
                'K-003351-031863-038162_0_2_0_2_70_000_200.png',
                'K-003351-032310-035206_0_2_0_2_75_000_200.png',
                'K-003351-032310-035206_0_2_0_2_90_000_200.png',
                'K-003351-032310-036637_0_2_0_2_70_000_200.png',
                'K-003351-032310-036637_0_2_0_2_90_000_200.png',
                'K-003351-032310-038162_0_2_0_2_70_000_200.png',
                'K-003351-032310-038162_0_2_0_2_90_000_200.png',
                'K-003351-033880-035206_0_2_0_2_75_000_200.png',
                'K-003351-033880-035206_0_2_0_2_90_000_200.png',
                'K-003351-033880-036637_0_2_0_2_75_000_200.png',
                'K-003351-033880-038162_0_2_0_2_70_000_200.png',
                'K-003351-033880-038162_0_2_0_2_75_000_200.png',
                'K-003351-035206-041768_0_2_0_2_70_000_200.png',
                'K-003351-035206-041768_0_2_0_2_90_000_200.png',
                'K-003351-036637-041768_0_2_0_2_70_000_200.png',
                'K-003351-036637-041768_0_2_0_2_90_000_200.png',
                'K-003351-038162-041768_0_2_0_2_70_000_200.png',
                'K-003351-038162-041768_0_2_0_2_75_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_70_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_75_000_200.png',
                'K-003483-016232-020877-030308_0_2_0_2_90_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_70_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_75_000_200.png',
                'K-003483-016232-020877-034597_0_2_0_2_90_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_70_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_75_000_200.png',
                'K-003483-016232-022347-025469_0_2_0_2_90_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_70_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_75_000_200.png',
                'K-003483-016262-019861-028763_0_2_0_2_90_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_70_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_75_000_200.png',
                'K-003483-016262-022347-027733_0_2_0_2_90_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_70_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_75_000_200.png',
                'K-003483-019861-020238-030308_0_2_0_2_90_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_70_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_75_000_200.png',
                'K-003483-020238-027733-028763_0_2_0_2_90_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_70_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_75_000_200.png',
                'K-003483-020877-031885-036637_0_2_0_2_90_000_200.png',
                'K-003483-025367-027733-029667_0_2_0_2_70_000_200.png',
                'K-003483-025367-027733-029667_0_2_0_2_75_000_200.png',
                'K-003483-025367-027733-029667_0_2_0_2_90_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_70_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_75_000_200.png',
                'K-003544-004543-012247-016548_0_2_0_2_90_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_70_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_75_000_200.png',
                'K-003544-004543-016548-027993_0_2_0_2_90_000_200.png']
    
    print("증강 데이터 생성 중...")
    print(f" - file_list1: 10개씩 증강 (총 {len(file_list1)}개 파일)")
    print(f" - file_list2: 4개씩 증강 (총 {len(file_list2)}개 파일)")
    print(f" - file_list3: 3개씩 증강 (총 {len(file_list3)}개 파일)")
    print(f" - file_list4: 2개씩 증강 (총 {len(file_list4)}개 파일)")
    print(f" - file_list5: 1개씩 증강 (총 {len(file_list5)}개 파일)\n")
    
    # 원본 이미지 디렉토리
    original_image_dir = image_dir
    
    # data_maker 함수 호출 (각 파일 리스트에 대해)
    print("▶ file_list1 증강 시작 (10개씩)...")
    data_maker(original_image_dir, annotation_dir, img_train_dir, label_train_dir, 
               transforms, file_list1, 10, class_dict)
    
    print("\n▶ file_list2 증강 시작 (4개씩)...")
    data_maker(original_image_dir, annotation_dir, img_train_dir, label_train_dir, 
               transforms, file_list2, 4, class_dict)
    
    print("\n▶ file_list3 증강 시작 (3개씩)...")
    data_maker(original_image_dir, annotation_dir, img_train_dir, label_train_dir, 
               transforms, file_list3, 3, class_dict)
    
    print("\n▶ file_list4 증강 시작 (2개씩)...")
    data_maker(original_image_dir, annotation_dir, img_train_dir, label_train_dir, 
               transforms, file_list4, 2, class_dict)
    
    print("\n▶ file_list5 증강 시작 (1개씩)...")
    data_maker(original_image_dir, annotation_dir, img_train_dir, label_train_dir, 
               transforms, file_list5, 1, class_dict)
    
    print("\n" + "="*80)
    print("✓ 데이터 준비 및 증강 완료!")
    print(f" - experiment4 폴더: {experiment4_dir}")
    print(f" - data.yaml: {data_yaml_path}")
    print(f" - 총 증강 이미지 수: 987개 (선명도 향상)")
    print("="*80 + "\n")
    
    return experiment4_dir

if __name__ == "__main__":
    result = prepare_experiment4_data()
    if result:
        print("\n 성공! 이제 yolo_train_experiment4.py를 실행하여 학습을 시작하세요.")
        print("   명령어: python src/model/yolo/yolo_train_experiment4.py")
    else:
        print("\n 데이터 준비 실패")

### 실행 명령어: python src/model/yolo/yolo_experiment2_data.py ###
